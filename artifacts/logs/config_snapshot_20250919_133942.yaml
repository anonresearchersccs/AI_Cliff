# YAML config for AI Diffusion Economics — v2
meta:
  project_name: "AI Diffusion Economics v2"
  author: "P. Martí et al."
  seed: 42
  smoketest: false  # true solo para tests sintéticos

paths:
  # Estos dos ficheros los genera el parche añadido al final de Data_AI-7:
  scaling_data: "./data/scaling_dataset.parquet"
  diffusion_data: "./data/diffusion_pairs.parquet"

exports:
  fig_dir: "./artifacts/figures"
  tab_dir: "./artifacts/tables"
  log_dir: "./artifacts/logs"
  model_dir: "./artifacts/models"

scaling_spec:
  # Variable dependiente principal de la especificación de escalado
  dep: "params"

  # Aliases de columnas (incluye los nombres que usa Data_AI-7)
  params_col: ["parameters","Parameters","n_params"]
  compute_col: ["train_compute_flops","Training compute (FLOP)","train_compute_floats","train_flops"]
  cost_col: ["train_cost_usd","Training compute cost (2023 USD)","cost_usd"]
  year_col: ["year","Year","release_year"]
  arch_col: ["architecture","Architecture","arch","model_family","Model family"]
  tier_col: ["tier"]
  org_type_col: ["org_type","Organization","org","developer_type"]

  # Escalas numéricas
  params_scale: 1e9     # parámetros en miles de millones
  compute_scale: 1.0    # FLOPs ya en unidades base
  cost_scale: 1.0       # USD nominales (2023) ya escalados

  # Fórmulas (patsy); FE de año y arquitectura
  form_params_vs_compute: "log_params ~ log_compute + C(year) + C(arch)"
  form_cost_vs_params:    "log_cost ~ log_params + C(year) + C(arch)"

  # Errores robustos
  robust_se: "HC3"

diffusion_spec:
  # Aliases de fechas (incluye variantes que aparecen en Data_AI-7)
  innov_date_col: ["innov_date","proprietary_date","date_innov","t0","prop_date_m","effective_date"]
  follower_date_col: ["follower_date","open_date","date_follow","t1","open_date_m"]

  # Covariables candidatas
  tier_col: ["tier"]
  org_type_col: ["org_type","Organization","org","developer_type"]
  openness_col: ["openness","is_open","open_source","Open?"]

  # Ventana (informativa para el pipeline de pairing)
  window_months: 60

  # Nombres de export de supervivencia
  km_fig: "survival_km.png"
  cox_fig: "cox_diagnostics.png"
  km_table: "km_summary.csv"
  cox_table: "cox_summary.csv"

investment_spec:
  # Escala objetivo del proyecto (1T parámetros = 1000 billions)
  target_params_billion: 1000.0

  # Exponentes de escalado (fallback si no hay regresiones previas)
  gamma_compute: 1.697
  gamma_cost: 0.702

  # Calibración (placeholders ajustables)
  compute_at_1b_params: 1.0e20     # FLOPs requeridos a 1B params
  price_per_flop_now: 2.0e-10      # USD por FLOP actuales
  price_decline_rate_annual: 0.35  # caída anual esperada en $/FLOP

  # Ingresos (pre-competencia) y shock tras TE
  revenue_lognorm_mu: 15.0         # media en log
  revenue_lognorm_sigma: 1.0       # desviación en log
  post_competition_drop: 0.7       # caída fraccional tras TE (70%)
  horizon_months: 72               # horizonte en meses

  # Descuento y Monte Carlo
  annual_discount_rate: 0.20
  n_sims: 10000

  # Búsqueda de APC* (mínimo share de CAPEX para E[NPV] ≥ 0)
  max_apc_share: 0.9
  tol_apc: 1.0e-4

  # Exports
  npv_hist_fig: "npv_hist.png"
  npv_summary_table: "npv_summary.csv"
  tornado_fig: "tornado_sensitivity.png"
